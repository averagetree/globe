import{r as e,h as t,H as a,g as r}from"./p-add854e8.js";import{i,j as s,g as n,b as o,c as h,k as d,f as l,h as c}from"./p-9786c541.js";import{r as u}from"./p-088d0b04.js";import"./p-928f4507.js";import"./p-b4fa3314.js";const g=class{constructor(t){e(this,t),this.hasRuler=!1,this.width=0,this.columns=0,this.interval=void 0,this.start="",this.end="",this.timezone="UTC",this.playhead=void 0}handleUpdate(e,t){t&&this.initializeRows()}handlePlayheadChange(){this.initializeRows()}handleTimezoneUpdate(){this.initializeRows()}handleTimeRegionChange(e){this.initializeRows(),e.stopPropagation()}connectedCallback(){this._handleSlotChange=this._handleSlotChange.bind(this)}_calculateGridColumnFromTime(e){if(this.start){let t=n(this.start,this.end,this.interval);if("hour"===this.interval)return Math.abs(o(t.timelineStart,new Date(e)))+2;if("minute"===this.interval){const a=Math.abs(function(e,t){u(2,arguments);var a=i(e,t)/1e3;return a>0?Math.floor(a):Math.ceil(a)}(t.timelineStart,new Date(e)));return a+2}if("day"===this.interval)return Math.abs(h(t.timelineStart,new Date(e)))+2;if("week"===this.interval){const a=new Date(e),r=Math.ceil(Math.abs(function(e,t){u(2,arguments);var a=s(e,t)/7;return a>0?Math.floor(a):Math.ceil(a)}(t.timelineStart,d(a,0)))),i=t.timelineStart.getDay();let n=a.getDay();return i>n&&(n+=7),Math.ceil(24*(r+(n-i)/7))+2}if("month"===this.interval){const a=new Date(e),r=Math.abs(l(t.timelineStart,a)),i=a.getDate()-1,s=c(a),n=a.getHours();return Math.ceil(24*(r+(i+n/24)/s))+2}}return 0}_validateTimeRegion(e,t){return e?t?new Date(e)>new Date(t)?{success:!1,error:`The Time Region start date must be before the end date: ${e} - ${t}`}:new Date(e)>new Date(this.end)?{success:!1,error:`The Time Region start date does not fall within the Timeline's range: ${e} - ${this.start}/${this.end}`}:new Date(e)<new Date(this.start)&&new Date(t)<new Date(this.start)?{success:!1,error:`The Time Region start and end dates do not fall within the Timeline's range: ${e} - ${t}`}:{success:!0}:{success:!1,error:"Time Region must have a end date provided"}:{success:!1,error:"Time Region must have a start date provided"}}initializeRows(){this.playhead&&(this.playedIndicator.style.gridColumnEnd=this._calculateGridColumnFromTime(this.playhead).toString());const e=[...this.el.children].filter((e=>"rux-time-region"===e.tagName.toLowerCase()));let t=n(this.start,this.end,this.interval);e.forEach((e=>{const a="hidden"===e.style.visibility,r=this._validateTimeRegion(e.start,e.end);let i=e.start,s=e.end,n=new Date(e.start),o=new Date(e.end);if(r.success){n<t.timelineStart&&o>t.timelineEnd?(e.partial="ongoing",i=t.timelineStart.toISOString(),s=t.timelineEnd.toISOString()):n<t.timelineStart?(e.partial="start",i=this.start):o>t.timelineEnd?(e.partial="end",s=t.timelineEnd.toISOString()):e.partial="none",e.timezone=this.timezone,e.style.gridRow="1",e.style.display="block";const a=`${this._calculateGridColumnFromTime(i)} / ${this._calculateGridColumnFromTime(s)}`;e.style.gridColumn=a}else a||(e.style.display="none")}))}_handleSlotChange(){this.initializeRows();const e=[...this.el.children].find((e=>"rux-ruler"===e.tagName.toLowerCase()));this.hasRuler=!!e}render(){return t(a,null,t("div",{class:"rux-timeline rux-track",style:{gridTemplateColumns:`[header] 200px repeat(${this.columns}, ${this.width}px)`},part:"container"},t("div",{class:"rux-track__header",part:"track-header",style:{gridRow:"1"}},t("slot",{name:"label"})),t("slot",{onSlotchange:this._handleSlotChange}),t("div",{class:{"rux-track__played":this.playhead,hidden:this.hasRuler},ref:e=>this.playedIndicator=e})))}get el(){return r(this)}static get watchers(){return{start:["handleUpdate"],end:["handleUpdate"],interval:["handleUpdate"],playhead:["handlePlayheadChange"],timezone:["handleTimezoneUpdate"]}}};g.style=".rux-track{background:var(--color-background-surface-default, #1b2d3e);width:fit-content;border-bottom:2px solid var(--color-background-base-default, #101923)}.rux-track__header{box-sizing:border-box;padding:11px 8px 13px 8px;background:var(--color-background-surface-default, #1b2d3e);border-right:2px solid var(--color-background-base-default, #101923);display:flex;align-items:center;font-family:var(--font-body-1-font-family, 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', Oxygen-Sans, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif);font-size:var(--font-body-1-font-size, 1rem);font-weight:var(--font-body-1-font-weight, 400);letter-spacing:var(--font-body-1-letter-spacing, 0.005em);position:sticky;left:0;min-width:184px;z-index:2}.rux-timeline{scrollbar-color:var(--color-border-interactive-muted, #2b659b);position:relative;display:grid;grid-template-rows:auto;background:var(--color-background-surface-default, #1b2d3e)}.rux-track__played{grid-row-start:1;grid-column-start:2;grid-row-end:auto;background:var(--color-background-surface-selected, #1c3f5e)}.hidden{display:none}";export{g as rux_track}